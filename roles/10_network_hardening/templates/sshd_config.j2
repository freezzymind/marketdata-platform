# --- SSH protocol --- 
Protocol 2
Port 22
AddressFamily inet
ListenAddress 0.0.0.0

# --- Login / Authentication ---
PermitRootLogin yes
PasswordAuthentication no
KbdInteractiveAuthentication no
ChallengeResponseAuthentication no
UsePAM yes
PubkeyAuthentication yes
AuthorizedKeysFile %h/.ssh/authorized_keys

# --- Limit authentication attempts --- 
MaxAuthTries 2
LoginGraceTime 10

# --- Connection limits / Anti-flood ---
MaxStartups 10:20:30
MaxSessions 10

# --- Session keepalive --- 
ClientAliveInterval 300
ClientAliveCountMax 0

# --- Disable risky features ---
AllowAgentForwarding no
AllowTcpForwarding local
X11Forwarding no

# --- Logging ---
LogLevel VERBOSE

# --- Modern crypto ---
Ciphers aes256-gcm@openssh.com
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org
MACs hmac-sha2-512-etm@openssh.com

# --- Host keys ---
HostKeyAlgorithms ssh-ed25519
HostKey /etc/ssh/ssh_host_ed25519_key